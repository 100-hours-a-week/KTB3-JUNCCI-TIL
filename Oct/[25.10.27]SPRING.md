# ğŸ“š SPRING í•µì‹¬ ê°œë… ì •ë¦¬(ORM, JPA, DTO, ENTITY)

---
ORM (Object-Relational Mapping) â†’ ê°ì²´ì™€ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì„ ìë™ìœ¼ë¡œ ë§¤í•‘í•´ì£¼ëŠ” ê¸°ìˆ .
âœ â€œê°ì²´ë¡œ DBë¥¼ ë‹¤ë£¨ê²Œ í•´ì£¼ëŠ” ë‹¤ë¦¬â€

JPA (Java Persistence API) â†’ ìë°” ì§„ì˜ì˜ ORM í‘œì¤€ ì¸í„°í˜ì´ìŠ¤.
âœ â€œORMì„ ì“°ê¸° ìœ„í•œ ê·œì¹™ì„œ (ëŒ€í‘œ êµ¬í˜„ì²´: Hibernate)â€

Entity â†’ ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸”ê³¼ 1:1ë¡œ ë§¤í•‘ë˜ëŠ” í´ë˜ìŠ¤.
âœ â€œDB ë ˆì½”ë“œ í•œ ì¤„ì„ í‘œí˜„í•˜ëŠ” ê°ì²´â€

DTO (Data Transfer Object) â†’ ê³„ì¸µ ê°„ ë°ì´í„° ì „ë‹¬ìš© ê°ì²´.
âœ â€œì—”í‹°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ë…¸ì¶œí•˜ì§€ ì•Šê³ , í•„ìš”í•œ ë°ì´í„°ë§Œ ë‹´ëŠ” ì „ì†¡ìš© ìƒìâ€

<img width="900" alt="JPA Sequence Diagram" src="https://github.com/user-attachments/assets/6dce6c8b-b467-42df-ae25-31fd27f725fc" />

<img width="900" alt="Mermaid JPA Diagram" src="https://github.com/user-attachments/assets/cf4e7b56-67f6-46e0-b758-97dff05a7278" />

## ğŸ§± ì „ì²´ êµ¬ì¡° ìš”ì•½

```
com.example.jpademo
â”œâ”€â”€ domain/           â† ì—”í‹°í‹° (JPA ê´€ë¦¬)
â”‚    â”œâ”€â”€ Member.java
â”‚    â””â”€â”€ Team.java
â”‚
â”œâ”€â”€ repository/       â† ë°ì´í„° ì ‘ê·¼ (DAO, Repository)
â”‚    â”œâ”€â”€ MemberRepository.java
â”‚    â””â”€â”€ TeamRepository.java
â”‚
â”œâ”€â”€ service/          â† ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (Service Layer)
â”‚    â””â”€â”€ MemberService.java
â”‚
â”œâ”€â”€ dto/              â† DTO (Data Transfer Object)
â”‚    â””â”€â”€ MemberDto.java
â”‚
â”œâ”€â”€ DemoRunner.java   â† í…ŒìŠ¤íŠ¸ìš© ì‹¤í–‰ í´ë˜ìŠ¤
â””â”€â”€ JpaDemoApplication.java  â† ë©”ì¸ ë¶€íŠ¸ìŠ¤íŠ¸ë© (Spring Boot ì‹œì‘ì )
```

---

## 1ï¸âƒ£ Entity (ë„ë©”ì¸ ê³„ì¸µ)

### ğŸ“ `domain/Member.java`

```java
@Entity
public class Member {
    @Id @GeneratedValue
    private Long id;
    private String name;
    private int age;

    @ManyToOne(fetch = FetchType.LAZY)
    private Team team;

    // getters/setters
}
```

### `domain/Team.java`

```java
@Entity
public class Team {
    @Id @GeneratedValue
    private Long id;
    private String name;

    // getters/setters
}
```

#### ğŸ’¡ ì—­í• 

* **JPAê°€ ì§ì ‘ ê´€ë¦¬í•˜ëŠ” ê°ì²´ (í…Œì´ë¸” ë§¤í•‘ ëŒ€ìƒ)**
* `@Entity` ë¶™ì€ í´ë˜ìŠ¤ëŠ” DB í…Œì´ë¸”ê³¼ 1:1 ëŒ€ì‘
* í•„ë“œ â†” ì»¬ëŸ¼ ìë™ ë§¤í•‘
* `@ManyToOne`, `@OneToMany` ê°™ì€ ê´€ê³„ ì„¤ì •ìœ¼ë¡œ ORM êµ¬í˜„

#### ì—¬ê¸°ì„œ ë°°ìš°ëŠ” JPA í•µì‹¬

* **ê°ì²´ ì¤‘ì‹¬ ê°œë°œ**: SQL ì¤‘ì‹¬ì´ ì•„ë‹Œ, ì—”í‹°í‹° ì¤‘ì‹¬ìœ¼ë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‘ì„±
* **ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸**ë¥¼ í†µí•´ ë³€ê²½ ê°ì§€, 1ì°¨ ìºì‹œ, ì§€ì—° ë¡œë”© ë“± í™œìš© ê°€ëŠ¥

---

## 2ï¸âƒ£ Repository (ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ)

### `repository/MemberRepository.java`

```java
public interface MemberRepository extends JpaRepository<Member, Long> {
    List<Member> findByName(String name);
}
```

### `repository/TeamRepository.java`

```java
public interface TeamRepository extends JpaRepository<Team, Long> {}
```

#### ğŸ’¡ ì—­í• 

* **ë°ì´í„° ì ‘ê·¼(DAO)** ì„ ëŒ€ì‹ í•˜ëŠ” ìŠ¤í”„ë§ ë°ì´í„° JPA ë ˆì´ì–´
* `JpaRepository`ë¥¼ ìƒì†í•˜ë©´ `save`, `findAll`, `findById`, `delete` ë“±ì´ ìë™ ì œê³µ
* **ë©”ì„œë“œ ì´ë¦„ìœ¼ë¡œ ì¿¼ë¦¬ ìë™ ìƒì„±** (e.g. `findByName`)

#### ì—¬ê¸°ì„œ ë°°ìš°ëŠ” JPA í•µì‹¬

* SQLì„ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šê³  **ë©”ì„œë“œ ë„¤ì´ë° ê·œì¹™ìœ¼ë¡œ ì¿¼ë¦¬ ìƒì„±**
* Spring Data JPAê°€ **í”„ë¡ì‹œ êµ¬í˜„ì²´ë¥¼ ìë™ ìƒì„±**

---

## 3ï¸âƒ£ Service (ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì¸µ)

### `service/MemberService.java`

```java
@Service
@Transactional(readOnly = true)
public class MemberService {
    private final MemberRepository memberRepository;

    public MemberService(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    public MemberDto getMemberDto(Long id) {
        Member member = memberRepository.findById(id).orElseThrow();
        return new MemberDto(member.getName(), member.getTeam().getName());
    }
}
```

#### ğŸ’¡ ì—­í• 

* **íŠ¸ëœì­ì…˜ ë‹¨ìœ„ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰**
* ì—¬ëŸ¬ Repositoryë¥¼ ì¡°í•©í•˜ê±°ë‚˜, ë„ë©”ì¸ ë¡œì§ì„ ê´€ë¦¬
* `@Transactional` ë¡œ íŠ¸ëœì­ì…˜ ë²”ìœ„ ì§€ì • (ìë™ ì»¤ë°‹/ë¡¤ë°±)

#### ì—¬ê¸°ì„œ ë°°ìš°ëŠ” JPA í•µì‹¬

* JPAëŠ” íŠ¸ëœì­ì…˜ ë²”ìœ„ ì•ˆì—ì„œë§Œ **ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê´€ë¦¬**
* ì„œë¹„ìŠ¤ ê³„ì¸µì´ **íŠ¸ëœì­ì…˜ ê²½ê³„ (Boundary)** ì—­í• ì„ í•¨

---

## 4ï¸âƒ£ DTO (ë°ì´í„° ì „ë‹¬ ê°ì²´)

### `dto/MemberDto.java`

```java
public class MemberDto {
    private String name;
    private String teamName;

    public MemberDto(String name, String teamName) {
        this.name = name;
        this.teamName = teamName;
    }

    // getters
}
```

#### ğŸ’¡ ì—­í• 

* **Entity â†’ ì™¸ë¶€ë¡œ ì „ë‹¬ ì‹œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ì „ìš© í´ë˜ìŠ¤**
* ì—”í‹°í‹°ë¥¼ ê·¸ëŒ€ë¡œ ë…¸ì¶œí•˜ì§€ ì•Šê³ , í•„ìš”í•œ ë°ì´í„°ë§Œ ì „ë‹¬

#### ì—¬ê¸°ì„œ ë°°ìš°ëŠ” í•µì‹¬

* **EntityëŠ” ë‚´ë¶€ ë¡œì§ ì¤‘ì‹¬**, **DTOëŠ” í‘œí˜„(View/API) ì¤‘ì‹¬**
* Controller, REST API ì‘ë‹µ, ë˜ëŠ” ì„œë¹„ìŠ¤ ë°˜í™˜ê°’ ë“±ì— DTO ì‚¬ìš©

---

## 5ï¸âƒ£ DemoRunner (ì‹¤í–‰ í…ŒìŠ¤íŠ¸)

```java
@Component
@Transactional
public class DemoRunner implements CommandLineRunner {

    private final MemberRepository memberRepository;
    private final TeamRepository teamRepository;
    private final MemberService memberService;

    public void run(String... args) {
        Team team = new Team();
        team.setName("Team A");
        teamRepository.save(team);

        Member member = new Member();
        member.setName("í™ê¸¸ë™");
        member.setAge(25);
        member.setTeam(team);
        memberRepository.save(member);

        var dto = memberService.getMemberDto(member.getId());
        System.out.println("DTO ì´ë¦„: " + dto.getName());
        System.out.println("DTO ì†Œì†íŒ€: " + dto.getTeamName());
    }
}
```

#### ğŸ’¡ ì—­í• 

* **Spring Boot ì‹¤í–‰ ì‹œ ìë™ ì‹¤í–‰ë˜ëŠ” í…ŒìŠ¤íŠ¸ìš© Runner**
* ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤ì œë¡œ JPAë¥¼ í†µí•´ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦

#### ì‹¤í–‰ íë¦„

1ï¸âƒ£ `JpaDemoApplication` â†’ Spring Boot ì‹¤í–‰
2ï¸âƒ£ `DemoRunner` ìë™ ì‹¤í–‰
3ï¸âƒ£ `Team`, `Member` ì €ì¥ â†’ JPAê°€ SQL ìƒì„± í›„ ì‹¤í–‰
4ï¸âƒ£ ì¡°íšŒ í›„ DTOë¡œ ë°˜í™˜

---

## ğŸ§  6ï¸âƒ£ ORM, JPA, Entity, DTOì˜ ê´€ê³„ ìš”ì•½

| ê°œë…                                  | ì„¤ëª…                                    | ì½”ë“œ ì˜ˆì‹œ                            |
| ----------------------------------- | ------------------------------------- | -------------------------------- |
| **ORM (Object Relational Mapping)** | ê°ì²´ë¥¼ ê´€ê³„í˜• DB í…Œì´ë¸”ê³¼ ìë™ ë§¤í•‘                 | `@Entity`, `@ManyToOne`          |
| **JPA (Java Persistence API)**      | ORMì„ ìœ„í•œ **í‘œì¤€ ì¸í„°í˜ì´ìŠ¤** (Hibernateê°€ êµ¬í˜„ì²´) | `JpaRepository`, `EntityManager` |
| **Entity**                          | JPAê°€ ê´€ë¦¬í•˜ëŠ” ë„ë©”ì¸ ê°ì²´                      | `Member`, `Team`                 |
| **DTO**                             | ê³„ì¸µ ê°„ ë°ì´í„° ì „ë‹¬ìš© ê°ì²´                       | `MemberDto`                      |
| **Repository**                      | DB ì ‘ê·¼ ë‹´ë‹¹, JPA ê¸°ë°˜ ì¿¼ë¦¬ ìƒì„±                | `MemberRepository`               |
| **Service**                         | íŠ¸ëœì­ì…˜/ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰                       | `MemberService`                  |

---


